


课 程 设 计 报 告

课程设计名称：软件工程与设计 

课程设计题目：GPX文件中提取相关数据并用Excel打印出来 

 
院（系）：计算机与信息工程学院 
专    业：软件工程 
班    级：2015级网络编程
学    号：20151104711
姓    名：丁楷轩 
Github网址：ciec20151104711 
指导教师：朝力萌 
完成日期：2016年7月15日

目    录

第1章  概要设计	2
1.1题目的内容与要求	2
1.2总体结构	2
第2章  详细设计	2
2.1主模块	2
第3章  调试分析	3
第4章  使用说明与执行结果	4


第1章  概要设计
1.1题目的内容与要求
要求能把GPX文件中的经度，维度，时间，日期提取出来，并且在Excel中打印出来
1.2总体结构
首先，定义数组和指针，用只读的方式打开文件并且写入文件.csv格式。通过用if语句来判断文件路径是否正确，如果不正确，执行“打开文件失败！”并跳出运行。如果存在，则执行测定文件长度的程序，并通过动态存储给定空间大小。然后利用while循环语句执行，当遇到</gpx>是停止循环，分别查找lat，lon，date，time所对应的数据。运用循环语句逐字符复制到字符串，然后将字符串写入.csv格式文件中。	


第2章  详细设计
2.1主模块
#include<stdio.h>
#include<stdlib.h>
#include<string.h>
int main()
{
    int len,i=0,a=0;
	char *ptr;
	char lat[20];
	char lon[20];
	char date[20];
	char time[20];
	FILE *fp;
    FILE *fp1;
	fp=fopen("export.gpx","r");
	fp1=fopen("export.csv","w"); 
	if((fp = fopen("export.gpx","r")) == 0)
	{
		printf("打开文件失败！");
		return -1;
	}
	else
	{
		fseek(fp,SEEK_SET,SEEK_END); 
	    len=ftell(fp);
	    fseek(fp,0,SEEK_SET);
	    ptr=new char[len+1];
	    fread(ptr,1,len,fp);
	}
	fprintf(fp1,"编号,纬度,经度,日期,时间\n");
	while(!((* (ptr + i) == '<') && (* (ptr + i + 1) == '/') && (* (ptr + i + 2) == 'g') && (* (ptr + i + 3) == 'p') && (* (ptr + i + 4) == 'x') && (* (ptr + i + 5) == '>'))) 
	{
		if((* (ptr + i) == ' ') && (* (ptr + i + 1) == 'l') && (* (ptr + i + 2) == 'a') && (* (ptr + i + 3) == 't')) 
		{
			strncpy(lat,&ptr[i+6],9);
		    strncpy(lon,&ptr[i+22],10);
		    strncpy(date,&ptr[i+44],10);
		    strncpy(time,&ptr[i+55],8);
		    lat[9]='\0';
		    lon[10]='\0';
		    date[10]='\0';
		    time[8]='\0';
		    fprintf(fp1,"%d,%s,%s,%s,%s\n",a+1,lat,lon,date,time);
		    a++;
		}
		i++;	
	}
	fclose(fp);
	fclose(fp1);
	free(ptr); 
	return 0;
}                             
第3章 调试分析
先编写一个简单的文件读取的程序
然后用fseek语句判断文件长度
用strncpy复制
最后写入到.csv格式的文件中
第4章  使用说明与执行结果
运行操作及结果:
打开程序并运行，再打开csv文件，文件的打开，读取，写入均正确。程序正常运行。
二．课程设计小结
  在实验中发现——分析——总结的问题有：
文件不能正常打开，但是程序可以运行。通过改变文件路径改正
While语句不能正常运行。通过改变循环中数组的大小改正
If语句不运行。通过删除if后面的分号改正
程序占用空间。利用动态存储改正
通过这次的实训发现自己的问题还有很多，许多知识虽然课上听懂了，但是课下不去复习，就会都忘了。而且在老师的指导下，学会了利用动态存储分配空间，还有fseek的运用以及strncpy的使用和fread的运用。也发现了自己的许多弊端，有些知识虽然看会了，但是等到真正上手运用就会发现自己需要学的还有很多。而且，通过老师的引导，我的目光不再仅仅局限于课本里的知识，要不断地从外界补充自己，让自己全面发展。


参考文献：
[1] 严蔚敏,吴伟民.数据结构（C语言版）.北京：清华大学出版社，2007
[2]《C程序设计基础教程》卡内特卡  电子工业出版社 
[3]《C语言设计基础实验指导》

  

